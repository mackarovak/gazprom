# Сервис статистики на FastAPI

Данный сервис на FastAPI предназначен для управления статистическими данными, собранными с различных устройств, принадлежащих пользователям. Он предоставляет функциональность для хранения, извлечения и анализа статистических данных, таких как значения `x`, `y` и `z`, записанные устройствами в течение времени.

## Установка

1. **Клонирование репозитория**: Склонируйте этот репозиторий на свой локальный компьютер.

    ```bash
    git clone git@github.com:mackarovak/gazprom.git
    ```

2. **Сборка Docker-образа**: Перейдите в каталог проекта и соберите Docker-образ с помощью предоставленного `Dockerfile`.

    ```bash
    cd gazprom
    docker build -t fastapi-stats .
    ```

3. **Запуск Docker Compose**: Запустите контейнеры Docker с помощью Docker Compose, который настроит как FastAPI-приложение, так и базу данных PostgreSQL.

    ```bash
    docker-compose up
    ```

    Если вы хотите запустить его в фоновом режиме, используйте флаг `-d`:

    ```bash
    docker-compose up -d
    ```

4. **Доступ к API**: После того как контейнеры Docker запущены, вы можете получить доступ к API с помощью вашего предпочтительного HTTP-клиента (например, браузер, cURL, Postman).

    - Базовый URL: `http://localhost:8000`

## Использование

API предоставляет несколько конечных точек для управления пользователями, устройствами и статистическими данными. Вот как вы можете взаимодействовать с API:

- **Вставка данных**: Используйте конечную точку `POST /device/{id_device}/readings`, чтобы вставить данные для определенного устройства.

- **Получение данных**: Используйте конечную точку `GET /device/{device_id}/readings`, чтобы получить данные для определенного устройства.

- **Получение статистики устройства**: Используйте конечную точку `GET /devices/{id}/stats/`, чтобы получить статистику для всех устройств в указанном временном диапазоне.

- **Создание пользователя**: Используйте конечную точку `POST /users/`, чтобы создать нового пользователя.

Для подробной документации API обратитесь к документации OpenAPI, сгенерированной FastAPI. Доступ к ней можно получить, посетив `http://localhost:8000/docs` в вашем браузере при запущенном сервере.

## Дополнительная информация

- Данный сервис использует PostgreSQL в качестве базы данных.
- Убедитесь, что вы правильно настроили подключение к базе данных в переменной окружения `DATABASE_URL`.
- Обязательно обработайте ошибки и крайние случаи адекватно в ваших клиентских приложениях.